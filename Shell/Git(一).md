# 创建git仓库

## git init

初始化一个仓库。

运行 `git init` 命令会初始化 Git 跟踪所有内容会用到的所有必要文件和目录。所有这些文件都存储在叫做 `.git`（注意开头有个 `.`，表示在 Mac/Linux 上，它将是一个隐藏目录）的目录下。这个 `.git` 目录是一个库！Git 会将所有 commit 记录在这里，并跟踪所有内容！

**.git 目录内容**

* **config 文件** - 存储了所有与项目有关的配置设置。

- **description 文件** - 此文件仅用于 GitWeb 程序，因此可以忽略

- **hooks 目录** - 我们会在此处放置客户端或服务器端脚本，以便用来连接到 Git 的不同生命周期事件

- **info 目录** - 包含全局排除文件

- **objects 目录** - 此目录将存储我们提交的所有 commit

- **refs 目录** - 此目录存储了指向 commit 的指针（通常是“分支”和“标签”）

## git clone

`git clone` 命令用于创建一个与现有仓库完全相同的副本。

```shell
$ git clone <path-to-repository-to-clone>
```

该命令：

- 会获取现有仓库的路径
- 默认地将创建一个与被克隆的仓库名称相同的目录
- 可以提供第二个参数，作为该目录的名称
- 将在现有工作目录下创建一个新的仓库

## git status

`git status` 命令将显示仓库的当前状态。

```bash
$ git status
```

我一直在强调这个命令非常的重要，因为这是你第一次使用 Git。该命令将：

- 告诉我们已在工作目录中被创建但 Git 尚未开始跟踪的新文件
- Git 正在跟踪的已修改文件
- 以及后续阶段学习的很多其他信息 ;-)。

## git add

> `git rm --cached` 与 shell 的 `rm` 命令不同，当你不小心运行了 `git add` 并提供了错误文件，它会提示你应该怎么操作。`git rm --cached` 不会破坏任何属于你的文件，它只是从暂存区删掉了文件。

```bash
$ git add <file1> <file2> … <fileN>
```

此命令：

- 可接受多个文件名（用空格分隔）
- 此外，可以使用句点 `.` 来代替文件列表，告诉 git 添加当前目录至暂存区（以及所有嵌套文件）

## git commit

```bash
$ git commit
```

此命令：

- 将打开配置中指定的代码编辑器
- （请参阅前面的 git 配置流程，了解如何配置编辑器）

在代码编辑器中：

- 必须提供提交说明
- 以 `#` 开头的行是注释，将不会被记录
- 添加提交说明后保存文件
- 关闭编辑器以进行提交

然后使用 `git log` 检查你刚刚提交的 commit！

可以使用 `git commit -m "Initial commit" ` 的 -m 选项绕过编辑器。

### 良好的提交说明

#### 建议

- 消息篇幅简短（少于 60 个字符）
- 解释提交的作用（不是如何更改或为何更改！）

#### 禁忌

- 请勿解释为何做出了这些更改（下文会深入讲解这一点）
- 请勿解释如何进行了更改（这是 `git log -p` 的目的！）
- 请勿使用单词"and"
- 如果你必须使用 "and"，则你的提交说明可能进行了太多的更改，将这些更改拆分为独立的 commit
- 例如 "make the background color pink *and* increase the size of the sidebar"

在编写提交说明时，我喜欢用以下短语造句："This commit will…"。你可以补充完整该句子并作为提交说明使用。

最重要的是，在编写提交说明时**保持一致性**！

### 解释原因

如果你需要解释为何进行了提交，也可以！

在编写提交说明时，第一行是消息本身。消息之后空一行，然后输入正文或说明，包括关于为何需要该 commit 的原因详情（例如 URL 链接）。

提交说明的详情描述部分包含在 `git log` 中。要查看带有详情描述的提交说明，请参阅博客项目仓库并查看 commit `8a11b3f`。

但是 `git log --oneline` 中仅包含了说明（第一行）！

## git diff

`git diff` 命令用来查看已经执行但是尚未 commit 的更改。

此命令会显示：

- 已经修改的文件
- 添加/删除的行所在的位置
- 执行的实际更改

## gitignore

如果你想将某个文件保留在项目的目录结构中，但是确保它不会意外地提交到项目中，可以使用名称特殊的文件 `.gitignore`（注意文件名开头的点，很重要！）。将此文件添加到 `new-git-project`项目根目录。你只需列出希望 git ignore（忽略，不跟踪）的文件名，git 将忽略这些文件。

`.gitignore` 文件用来告诉 git 不应跟踪的文件。该文件应该放在 `.git` 目录所在的目录。

## 通配符速成

假设你向项目中添加了 50 个图片，但是希望 git 忽略所有这些图片。这样的话，是否需要将每个文件名都列在 `.gitignore` 文件中呢？当然不用了，要不然太可怕了！相反，你可以采用一个叫做 **通配符** 的概念。

通配符允许你使用特殊的字符来表示某些格式/字符。在 `.gitignore` 文件中，你可以使用：

- 空白行作为空格
- `#` - 将行标记为注释
- `*` - 与 0 个或多个字符匹配
- `?` - 与 1 个字符匹配
- `[abc]` - 与 a、b 或 c 匹配
- `**` - 与嵌套目录匹配 - `a/**/z` 与以下项匹配
  - a/z
  - a/b/z
  - a/b/c/z

因此如果所有 50 个图片都是 JPEG 图片，并且位于"samples"文件夹中，那么我们可以向 `.gitignore` 中添加以下行，使 git 忽略所有这 50 个图片。

```bash
samples/*.jpg
```

# 查看仓库的历史记录

## git log

`git log` 命令用于显示仓库中所有 commit 的信息。

`git log` 命令显示的信息远不止这些。

git 使用命令行分页器 less 浏览所有信息。以下是 less 的重要快捷键：

- 要按行向下滚动，使用 `j` 或 `↓`
- 要按行向上滚动，使用 `k` 或 `↑`
- 要按页向下滚动，使用空格键或 Page Down 按钮
- 要按页向下滚动，使用 `b` 或 Page Up 按钮
- 要退出，使用 `q`

`git log` 显示的详细信息：

- **SHA** - `git log` 将显示每个 commit 的完整 SHA。每个 SHA 都是唯一的，因此，我不需要查看整个 SHA。只需知道前 6-8 个字符即可。如果我们能只显示 SHA 的前 5 个左右的字符，是不是会节省一些空间？
- **作者** - `git log` 输出结果显示了每个 commit 的作者！其他仓库可能有多个人协作，因此情况可能不同，但是对于此仓库，只有一个人提交了所有的 commit，因此所有 commit 的作者是一样的。我们需要查看每个 commit 的作者吗？如果我们想隐藏这一信息呢？
- **日期** - 默认情况下，`git log` 将显示每个 commit 的日期。但是我们真的关心 commit 的日期吗？知道日期有时会很重要，但是每次都知道日期并不十分重要，在很多情况下都可以忽略。能否隐藏该信息，以便节省空间？
- **commit 消息** - 这是 commit 消息最重要的部分…我们通常都希望看到此信息

### git log --online

`--oneline` 选项用于更改 `git log` 显示信息的方式：

```bash
$ git log --oneline
```

此命令：

- 每行显示一个 commit
- 显示 commit 的 SHA 的前 7 个字符
- 显示 commit 的消息

### git log --stat

The `git log` 命令有一个选项可以用来显示 commit 中更改的文件以及添加或删除的行数。该选项为 `--stat`（stat 是“统计信息 statistics”的简称）：

```bash
$ git log --stat
```

此命令会：

- 显示被修改的文件
- 显示添加/删除的行数
- 显示一个摘要，其中包含修改/删除的总文件数和总行数

### git log -p

`git log` 命令具有一个可用来显示对文件作出实际更改的选项。该选项是 `--patch`，可以简写为 `-p`：

```bash
$ git log -p
```

此命令会向默认输出中添加以下信息：

- 显示被修改的文件
- 显示添加/删除的行所在的位置
- 显示做出的实际更改

### git log -p  --stat

同时显示两种信息，并且统计信息显示在补丁信息上方。

```bash
$ git log -p fdf5493
```

通过提供 SHA，`git log -p` 命令将从这条 commit 开始！无需滚动并逐条查阅！注意，它还会显示在所提供的 SHA 之前提交的所有 commit 信息。

### git show

`git show` 命令将仅显示一个 commit。因此，如果你看不到任何其他 commit，不要惊慌。它只显示一个 commit。`git show` 命令的输出和 `git log -p` 命令的完全一样。因此默认情况下，`git show` 会显示：

- commit
- 作者
- 日期
- commit 消息
- 补丁信息

但是，`git show` 可以与我们了解过的大部分其他选项一起使用：

- `--stat` - 显示更改了多少文件，以及添加/删除的行数
- `-p` 或 `--patch` - 显示默认补丁信息，但是如果使用了 `--stat`，将不显示补丁信息，因此传入 `-p` 以再次添加该信息
- `-w` - 忽略空格变化

