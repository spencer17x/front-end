<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <style>
    body {
      background-color: #111;
      overflow: hidden;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    body,
    html {
      height: 100%;
      width: 100%;
      margin: 0;
      padding: 0;
    }

    svg {
      width: 100%;
      height: 100%;
      visibility: hidden;

    }


    .ring,
    #d0ot {
      mix-blend-mode: overlay;
    }
  </style>
</head>

<body>
  <svg class="mainSVG" viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <filter id="glow" x="-100%" y="-100%" width="250%" height="250%">
        <feGaussianBlur stdDeviation="10" result="coloredBlur" />
        <feOffset dx="0" dy="0" result="offsetblur"></feOffset>
        <feFlood id="glowAlpha" flood-color="#38DFF1" flood-opacity="0.3"></feFlood>
        <feComposite in2="offsetblur" operator="in"></feComposite>
        <feMerge>
          <feMergeNode />
          <feMergeNode in="SourceGraphic"></feMergeNode>
        </feMerge>
      </filter>

      <radialGradient id="bgGrad" cx="400" cy="300" r="220" gradientUnits="userSpaceOnUse">
        <stop offset="0" style="stop-color:#0867C7" />
        <stop offset="0.86" style="stop-color:#111" stop-opacity="0" />
      </radialGradient>
      <circle class="particle" cx="0" cy="0" r="1" />
      <path id="orbit" fill="none" stroke="none" stroke-width="4" stroke-miterlimit="10" d="M300,80c121.5,0,220,98.5,220,220S421.5,520,300,520,80,421.5,80,300,178.5,80,300,80" />
    </defs>

    <rect fill="url(#bgGrad)" width="800" height="600" />
    <radialGradient id="dotGrad" cx="0" cy="0" r="50" gradientUnits="userSpaceOnUse">
      <stop offset="0" style="stop-color:#FFFFFF;stop-opacity:1" />
      <!-- <stop  offset="0.3" style="stop-color:#FD3A02;stop-opacity:0.6"/> -->
      <stop offset="0.3" style="stop-color:#0867C7;stop-opacity:0.6" />
      <stop offset="0.8" style="stop-color:#081029;stop-opacity:0" />
    </radialGradient>
    <g id="pContainer" />
    <g class="whole">
      <circle id="dot" fill="url(#dotGrad)" cx="0" cy="0" r="50" />
      <circle class="ring" filter="url(#glow)" cx="400" cy="300" r="220" fill="none" stroke="#64A8AF" stroke-width="34"
        opacity="1" />
    </g>
    <circle id="follower" fill="#081029" cx="0" cy="0" r="0" />
  </svg>
  <script>
    class App {

      xmlns = "http://www.w3.org/2000/svg";
      xlinkns = "http://www.w3.org/1999/xlink";
      select = e => document.querySelector(e);
      selectAll = e => document.querySelectorAll(e);
      mainTl = new TimelineMax();
      mainSVG = this.select('.mainSVG');
      ring = this.select('.ring');
      whole = this.select('.whole');
      dot = this.select('#dot');
      follower = this.select('#follower');
      particle = this.select('.particle');
      pContainer = this.select('#pContainer');
      particlePool = [];
      numParticles = 275;
      particleCount = 0;
      colorArray = ["#451A60", "#25245F", '#26247D', '#303894', '#1F45B9', '#2F5AA0', '#3276CD', '#3B94E6', '#41C2F4',
        '#50F7FE', '#7DFFFE', '#EABEFC', '#64A8AF'
      ];


      constructor() {

        const strokeWidth = 12;
        TweenMax.set(this.ring, {
          strokeWidth: strokeWidth,
          svgOrigin: '400 300'
        })
        TweenMax.set(this.whole, {
          svgOrigin: '400 300'

        })

        const tl = new TimelineMax({
          repeat: -1,
          yoyo: false,
          onUpdate: this.playParticle,
          onUpdateScope: this
        });

        let orbitPath = MorphSVGPlugin.pathDataToBezier(this.ring, {
          offsetX: 0,
          offsetY: 0
        })



        tl.to(this.dot, 2.6, {
          bezier: {
            type: "cubic",
            values: orbitPath,
            autoRotate: false
          },
          ease: Linear.easeNone
        })

        this.createParticles();
      }

      createParticles = () => {

        let i = this.numParticles,
          p;
        while (--i > -1) {

          p = this.particle.cloneNode(true);
          this.pContainer.appendChild(p);
          TweenMax.set(p, {
            alpha: 0,
            fill: this.colorArray[i % this.colorArray.length]
          })

          this.particlePool.push(p);
          this.completeParticle(p);

        }

      }

      playParticle = () => {
        let p = this.particlePool[this.particleCount];
        let curr = {
          x: this.dot._gsTransform.x,
          y: this.dot._gsTransform.y
        };
        let rad = Math.atan2(curr.y - 300, curr.x - 400);
        let deg = Math.round(rad * (180 / Math.PI));
        TweenMax.set(p, {
          x: this.randomBetween(curr.x, curr.x - (strokeWidth / 10)),
          y: this.randomBetween(curr.y, curr.y + (strokeWidth / 10)),
          alpha: 1,
          transformOrigin: '50% 50%'
        });
        let tl = new TimelineMax();
        tl.to(p, this.randomBetween(3, 6), {
          physics2D: {
            velocity: this.randomBetween(5, 56),
            angle: (deg % 2) ? deg : deg - 180,
            gravity: this.randomBetween(-3, 3)
          },
          onUpdate: this.onUpdate,
          scale: this.randomBetween(10, 33) / 10,
          onComplete: this.completeParticle,
          onCompleteParams: [p],
          ease: Expo.easeInOut,
          alpha: 0
        });

        this.particleCount++;

        this.particleCount = (this.particleCount >= this.numParticles) ? 0 : this.particleCount
      }

      completeParticle = (p) => {
        TweenMax.set(p, {
          x: -10,
          y: -10,
          //alpha:1,
          scale: this.randomBetween(5, 20) / 10
        })
      }
      randomBetween = (min, max) => {
        return Math.floor(Math.random() * (max - min + 1) + min);
      }
    }


    TweenMax.set('svg', {
      visibility: 'visible'
    })

    let app = new App();
  </script>
</body>

</html>