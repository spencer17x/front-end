---
title: JavaScript面向对象(一)
date: 2018-07-14 23:48:20
tags:
        - 2018.7
categories:
        - JavaScript学习笔记
---

# 预编译四部曲

1. 创建AO对象(执行期上下文)
2. 找形参和变量声明，将变量和形参名作为AO属性名，值为undefined
3. 将实参值和形参统一
4. 在函数体里面找函数声明，值赋予函数体

# 作用域

- [[scope]]: 每个JavaScript函数都是一个对象，对象中有些属性我们可以访问，但有些不可以，这些属性仅供JavaScript引擎存取，[[scope]]就是其中一个。

> [[scope]]指的就是我们所说的作用域，其中存储了运行期上下文的集合。

- 作用域链: [[scope]]所存储的执行期上下文对象的集合，这个集合呈链式链接，我们把这种链式链接叫做作用域。
- 运行期上下文: 当函数执行时，会创建一个称为执行期上下文的内部对象。一个执行期上下文定义了一个函数执行时的环境，函数每次执行时对应的执行上下文都是独一无二的，所以多次调用一个函数会导致创建多个执行上下文，当函数执行完毕，它所产生的执行上下文被销毁。
- 查找变量: 从作用域链的顶端依次向下查找。

# 闭包

- 当内部函数被保存在外部时，将会生成闭包。闭包会导致原有作用域链不释放，造成内存泄漏。

# 立即执行函数

> 只有表达式才能被执行

```
//特例
function test(a,b,c,d) {
    console.log(a + b + c +d);
}(1,2,3,4) //4
会识别成以下方式: 
function test(a,b,c,d) {
    console.log(a + b + c +d);
}
(1,2,3,4)
```

# 构造函数内部原理

1. 在函数体最前面隐式的加上var this={};
2. 执行this.xxx = xxx;
3. 隐式的返回this

```
function Person() {
    this.a = 1;
    return {};
}
var person = new Person(); //{}

function Person() {
    this.a = 1;
    return 123;
}
var person = new Person(); //{a: 1}
```

